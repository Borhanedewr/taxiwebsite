<header>
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <a href="{{ '/' | relative_url }}">Taxi<span class="highlight">Go</span>‎ Neumünster</a>
      </div>
      <nav>
        <input type="checkbox" id="nav-toggle">
        <label for="nav-toggle" class="nav-toggle-label">
          <span></span>
        </label>
        <ul class="nav-menu">
          {% assign is_en = page.lang == 'en' or page.url contains '/en/' %}
          {% if is_en %}
            <li><a href="/en/" {% if page.url == '/en/' %}class="active"{% endif %}>Home</a></li>
            <li><a href="/en/services/" {% if page.url contains '/en/services' %}class="active"{% endif %}>Services</a></li>
            <li><a href="/en/about/" {% if page.url contains '/en/about' %}class="active"{% endif %}>About</a></li>
            <li><a href="/en/contact/" {% if page.url contains '/en/contact' %}class="active"{% endif %}>Contact</a></li>
            <li>
              <a href="/en/qr/" class="btn-order">
                <span class="btn-order-svg" aria-hidden="true" style="display:inline-block;vertical-align:middle;width:1.7em;height:1em;margin-right:0.5em;line-height:0;">
                  <svg style="scale: 1.4; rotate: 45deg" width="100%" height="100%" viewBox="0 0 2000 1000" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <g>
                      <path d="m 469.47242,102.80848 c 180.80494,0 502.69549,242.03857 635.50638,348.16324 31.6513,25.44507 31.6513,72.61158 0,98.05669 -132.81089,106.1246 -454.70144,348.16311 -635.50638,348.16311 -219.28286,0 -397.191542,-177.90858 -397.191542,-397.19149 0,-219.28275 177.908682,-397.19156 397.191542,-397.19155 z" style="fill:#ff0000;stroke:#000000;stroke-width:70;"/>
                      <text x="251.8175" y="682.95233" style="font-family:Roboto,Arial,sans-serif;font-weight:900;font-size:692.33px;fill:#ffffff;">to</text>
                      <text x="1237.2054" y="682.95233" style="font-family:Roboto,Arial,sans-serif;font-weight:900;font-size:692.33px;fill:#000000;">yu</text>
                    </g>
                  </svg>
                </span>
                Order online
              </a>
            </li>
          {% else %}
            <li><a href="{{ '/' | relative_url }}" {% if page.url == '/' %}class="active"{% endif %}>Startseite</a></li>
            <li><a href="{{ '/leistungen/' | relative_url }}" {% if page.url contains 'leistungen' %}class="active"{% endif %}>Leistungen</a></li>
            <li><a href="{{ '/ueber-uns/' | relative_url }}" {% if page.url contains 'ueber-uns' %}class="active"{% endif %}>Über uns</a></li>
            <li><a href="{{ '/contact/' | relative_url }}" {% if page.url contains 'contact' %}class="active"{% endif %}>Kontakt</a></li>
            <li>
              <a href="{{ '/qr' | relative_url }}" class="btn-order">
                <span class="btn-order-svg" aria-hidden="true" style="display:inline-block;vertical-align:middle;width:1.7em;height:1em;margin-right:0.5em;line-height:0;">
                  <svg style="scale: 1.4; rotate: 45deg" width="100%" height="100%" viewBox="0 0 2000 1000" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <g>
                      <path d="m 469.47242,102.80848 c 180.80494,0 502.69549,242.03857 635.50638,348.16324 31.6513,25.44507 31.6513,72.61158 0,98.05669 -132.81089,106.1246 -454.70144,348.16311 -635.50638,348.16311 -219.28286,0 -397.191542,-177.90858 -397.191542,-397.19149 0,-219.28275 177.908682,-397.19156 397.191542,-397.19155 z" style="fill:#ff0000;stroke:#000000;stroke-width:70;"/>
                      <text x="251.8175" y="682.95233" style="font-family:Roboto,Arial,sans-serif;font-weight:900;font-size:692.33px;fill:#ffffff;">to</text>
                      <text x="1237.2054" y="682.95233" style="font-family:Roboto,Arial,sans-serif;font-weight:900;font-size:692.33px;fill:#000000;">yu</text>
                    </g>
                  </svg>
                </span>
                Online bestellen
              </a>
            </li>
          {% endif %}
          <li class="lang-switcher" style="margin-left:1.5rem;">
            <form method="get" id="langForm" style="display:inline;">
              <select name="lang" id="langSelect" style="padding:0.3em 1.2em;border-radius:999px;font-weight:600;font-size:1em;">
                <option value="de" {% unless is_en %}selected{% endunless %}>Deutsch</option>
                <option value="en" {% if is_en %}selected{% endif %}>English</option>
              </select>
            </form>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</header>
<!-- Floating Order Button for Mobile -->
<a href="{% if is_en %}/en/qr/{% else %}{{ '/qr' | relative_url }}{% endif %}" class="btn-order-mobile" style="display:none">
  <span class="btn-order-svg" aria-hidden="true" style="display:inline-block;vertical-align:middle;width:1.7em;height:1em;margin-right:0.5em;line-height:0;">
    <svg style="scale: 1.4; rotate: 45deg" width="100%" height="100%" viewBox="0 0 2000 1000" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
      <g>
        <path d="m 469.47242,102.80848 c 180.80494,0 502.69549,242.03857 635.50638,348.16324 31.6513,25.44507 31.6513,72.61158 0,98.05669 -132.81089,106.1246 -454.70144,348.16311 -635.50638,348.16311 -219.28286,0 -397.191542,-177.90858 -397.191542,-397.19149 0,-219.28275 177.908682,-397.19156 397.191542,-397.19155 z" style="fill:#ff0000;stroke:#000000;stroke-width:70;"/>
        <text x="251.8175" y="682.95233" style="font-family:Roboto,Arial,sans-serif;font-weight:900;font-size:692.33px;fill:#ffffff;">to</text>
        <text x="1237.2054" y="682.95233" style="font-family:Roboto,Arial,sans-serif;font-weight:900;font-size:692.33px;fill:#000000;">yu</text>
      </g>
    </svg>
  </span>
  {% if is_en %}Order online{% else %}Online bestellen{% endif %}
</a>
<script>
  // Floating Button Sichtbarkeit
  function toggleOrderBtn() {
    const btn = document.querySelector('.btn-order-mobile');
    if (window.innerWidth <= 900) {
      btn.style.display = 'flex';
    } else {
      btn.style.display = 'none';
    }
  }
  window.addEventListener('resize', toggleOrderBtn);
  window.addEventListener('DOMContentLoaded', toggleOrderBtn);

  // Sprachumschalter
  document.addEventListener('DOMContentLoaded', function() {
    var langSelect = document.getElementById('langSelect');
    if(langSelect) {
      langSelect.addEventListener('change', function() {
        var val = this.value;
        var path = window.location.pathname;
        if(val === 'en') {
          if(!path.startsWith('/en/')) {
            window.location.href = '/en/' + (path === '/' ? '' : path.replace(/^\//, ''));
          }
        } else {
          if(path.startsWith('/en/')) {
            window.location.href = '/' + path.replace(/^\/en\//, '');
          }
        }
        localStorage.setItem('langSelected', val);
      });
    }

    // Automatische Sprachweiterleitung nur beim ersten Besuch
    if(!localStorage.getItem('langSelected')) {
      var userLang = (navigator.language || navigator.userLanguage || '').toLowerCase();
      if(userLang.startsWith('en') && !window.location.pathname.startsWith('/en/')) {
        window.location.href = '/en/';
      }
    }
  });
</script>
